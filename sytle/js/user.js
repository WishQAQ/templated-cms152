//
// Generated on Wed Jun 25 2014 00:16:13 GMT-0700 (PDT) by Nodejitsu, Inc (Using Codesurgeon).
// Version 1.2.4
//
(function(a){function k(a,b,c,d){var e=0,f=0,g=0,c=(c||"(").toString(),d=(d||")").toString(),h;for(h=0;h<a.length;h++){var i=a[h];if(i.indexOf(c,e)>i.indexOf(d,e)||~i.indexOf(c,e)&&!~i.indexOf(d,e)||!~i.indexOf(c,e)&&~i.indexOf(d,e)){f=i.indexOf(c,e),g=i.indexOf(d,e);if(~f&&!~g||!~f&&~g){var j=a.slice(0,(h||1)+1).join(b);a=[j].concat(a.slice((h||1)+1))}e=(g>f?g:f)+1,h=0}else e=0}return a}function j(a,b){var c,d=0,e="";while(c=a.substr(d).match(/[^\w\d\- %@&]*\*[^\w\d\- %@&]*/))d=c.index+c[0].length,c[0]=c[0].replace(/^\*/,"([_.()!\\ %@&a-zA-Z0-9-]+)"),e+=a.substr(0,c.index)+c[0];a=e+=a.substr(d);var f=a.match(/:([^\/]+)/ig),g,h;if(f){h=f.length;for(var j=0;j<h;j++)g=f[j],g.slice(0,2)==="::"?a=g.slice(1):a=a.replace(g,i(g,b))}return a}function i(a,b,c){c=a;for(var d in b)if(b.hasOwnProperty(d)){c=b[d](a);if(c!==a)break}return c===a?"([._a-zA-Z0-9-]+)":c}function h(a,b,c){if(!a.length)return c();var d=0;(function e(){b(a[d],function(b){b||b===!1?(c(b),c=function(){}):(d+=1,d===a.length?c():e())})})()}function g(a){var b=[];for(var c=0,d=a.length;c<d;c++)b=b.concat(a[c]);return b}function f(a,b){for(var c=0;c<a.length;c+=1)if(b(a[c],c,a)===!1)return}function c(){return b.hash===""||b.hash==="#"}var b=document.location,d={mode:"modern",hash:b.hash,history:!1,check:function(){var a=b.hash;a!=this.hash&&(this.hash=a,this.onHashChanged())},fire:function(){this.mode==="modern"?this.history===!0?window.onpopstate():window.onhashchange():this.onHashChanged()},init:function(a,b){function d(a){for(var b=0,c=e.listeners.length;b<c;b++)e.listeners[b](a)}var c=this;this.history=b,e.listeners||(e.listeners=[]);if("onhashchange"in window&&(document.documentMode===undefined||document.documentMode>7))this.history===!0?setTimeout(function(){window.onpopstate=d},500):window.onhashchange=d,this.mode="modern";else{var f=document.createElement("iframe");f.id="state-frame",f.style.display="none",document.body.appendChild(f),this.writeFrame(""),"onpropertychange"in document&&"attachEvent"in document&&document.attachEvent("onpropertychange",function(){event.propertyName==="location"&&c.check()}),window.setInterval(function(){c.check()},50),this.onHashChanged=d,this.mode="legacy"}e.listeners.push(a);return this.mode},destroy:function(a){if(!!e&&!!e.listeners){var b=e.listeners;for(var c=b.length-1;c>=0;c--)b[c]===a&&b.splice(c,1)}},setHash:function(a){this.mode==="legacy"&&this.writeFrame(a),this.history===!0?(window.history.pushState({},document.title,a),this.fire()):b.hash=a[0]==="/"?a:"/"+a;return this},writeFrame:function(a){var b=document.getElementById("state-frame"),c=b.contentDocument||b.contentWindow.document;c.open(),c.write("<script>_hash = '"+a+"'; onload = parent.listener.syncHash;<script>"),c.close()},syncHash:function(){var a=this._hash;a!=b.hash&&(b.hash=a);return this},onHashChanged:function(){}},e=a.Router=function(a){if(this instanceof e)this.params={},this.routes={},this.methods=["on","once","after","before"],this.scope=[],this._methods={},this._insert=this.insert,this.insert=this.insertEx,this.historySupport=(window.history!=null?window.history.pushState:null)!=null,this.configure(),this.mount(a||{});else return new e(a)};e.prototype.init=function(a){var e=this;this.handler=function(a){var b=a&&a.newURL||window.location.hash,c=e.history===!0?e.getPath():b.replace(/.*#/,"");e.dispatch("on",c.charAt(0)==="/"?c:"/"+c)},d.init(this.handler,this.history);if(this.history===!1)c()&&a?b.hash=a:c()||e.dispatch("on","/"+b.hash.replace(/^(#\/|#|\/)/,""));else{var f=c()&&a?a:c()?null:b.hash.replace(/^#/,"");f&&window.history.replaceState({},document.title,f),(f||this.run_in_init===!0)&&this.handler()}return this},e.prototype.explode=function(){var a=this.history===!0?this.getPath():b.hash;a.charAt(1)==="/"&&(a=a.slice(1));return a.slice(1,a.length).split("/")},e.prototype.setRoute=function(a,b,c){var e=this.explode();typeof a=="number"&&typeof b=="string"?e[a]=b:typeof c=="string"?e.splice(a,b,s):e=[a],d.setHash(e.join("/"));return e},e.prototype.insertEx=function(a,b,c,d){a==="once"&&(a="on",c=function(a){var b=!1;return function(){if(!b){b=!0;return a.apply(this,arguments)}}}(c));return this._insert(a,b,c,d)},e.prototype.getRoute=function(a){var b=a;if(typeof a=="number")b=this.explode()[a];else if(typeof a=="string"){var c=this.explode();b=c.indexOf(a)}else b=this.explode();return b},e.prototype.destroy=function(){d.destroy(this.handler);return this},e.prototype.getPath=function(){var a=window.location.pathname;a.substr(0,1)!=="/"&&(a="/"+a);return a},e.prototype.configure=function(a){a=a||{};for(var b=0;b<this.methods.length;b++)this._methods[this.methods[b]]=!0;this.recurse=a.recurse||this.recurse||!1,this.async=a.async||!1,this.delimiter=a.delimiter||"/",this.strict=typeof a.strict=="undefined"?!0:a.strict,this.notfound=a.notfound,this.resource=a.resource,this.history=a.html5history&&this.historySupport||!1,this.run_in_init=this.history===!0&&a.run_handler_in_init!==!1,this.every={after:a.after||null,before:a.before||null,on:a.on||null};return this},e.prototype.param=function(a,b){a[0]!==":"&&(a=":"+a);var c=new RegExp(a,"g");this.params[a]=function(a){return a.replace(c,b.source||b)};return this},e.prototype.on=e.prototype.route=function(a,b,c){var d=this;!c&&typeof b=="function"&&(c=b,b=a,a="on");if(Array.isArray(b))return b.forEach(function(b){d.on(a,b,c)});b.source&&(b=b.source.replace(/\\\//ig,"/"));if(Array.isArray(a))return a.forEach(function(a){d.on(a.toLowerCase(),b,c)});b=b.split(new RegExp(this.delimiter)),b=k(b,this.delimiter),this.insert(a,this.scope.concat(b),c)},e.prototype.path=function(a,b){var c=this,d=this.scope.length;a.source&&(a=a.source.replace(/\\\//ig,"/")),a=a.split(new RegExp(this.delimiter)),a=k(a,this.delimiter),this.scope=this.scope.concat(a),b.call(this,this),this.scope.splice(d,a.length)},e.prototype.dispatch=function(a,b,c){function h(){d.last=e.after,d.invoke(d.runlist(e),d,c)}var d=this,e=this.traverse(a,b,this.routes,""),f=this._invoked,g;this._invoked=!0;if(!e||e.length===0){this.last=[],typeof this.notfound=="function"&&this.invoke([this.notfound],{method:a,path:b},c);return!1}this.recurse==="forward"&&(e=e.reverse()),g=this.every&&this.every.after?[this.every.after].concat(this.last):[this.last];if(g&&g.length>0&&f){this.async?this.invoke(g,this,h):(this.invoke(g,this),h());return!0}h();return!0},e.prototype.invoke=function(a,b,c){var d=this,e;this.async?(e=function(c,d){if(Array.isArray(c))return h(c,e,d);typeof c=="function"&&c.apply(b,(a.captures||[]).concat(d))},h(a,e,function(){c&&c.apply(b,arguments)})):(e=function(c){if(Array.isArray(c))return f(c,e);if(typeof c=="function")return c.apply(b,a.captures||[]);typeof c=="string"&&d.resource&&d.resource[c].apply(b,a.captures||[])},f(a,e))},e.prototype.traverse=function(a,b,c,d,e){function l(a){function c(a){for(var b=a.length-1;b>=0;b--)Array.isArray(a[b])?(c(a[b]),a[b].length===0&&a.splice(b,1)):e(a[b])||a.splice(b,1)}function b(a){var c=[];for(var d=0;d<a.length;d++)c[d]=Array.isArray(a[d])?b(a[d]):a[d];return c}if(!e)return a;var d=b(a);d.matched=a.matched,d.captures=a.captures,d.after=a.after.filter(e),c(d);return d}var f=[],g,h,i,j,k;if(b===this.delimiter&&c[a]){j=[[c.before,c[a]].filter(Boolean)],j.after=[c.after].filter(Boolean),j.matched=!0,j.captures=[];return l(j)}for(var m in c)if(c.hasOwnProperty(m)&&(!this._methods[m]||this._methods[m]&&typeof c[m]=="object"&&!Array.isArray(c[m]))){g=h=d+this.delimiter+m,this.strict||(h+="["+this.delimiter+"]?"),i=b.match(new RegExp("^"+h));if(!i)continue;if(i[0]&&i[0]==b&&c[m][a]){j=[[c[m].before,c[m][a]].filter(Boolean)],j.after=[c[m].after].filter(Boolean),j.matched=!0,j.captures=i.slice(1),this.recurse&&c===this.routes&&(j.push([c.before,c.on].filter(Boolean)),j.after=j.after.concat([c.after].filter(Boolean)));return l(j)}j=this.traverse(a,b,c[m],g);if(j.matched){j.length>0&&(f=f.concat(j)),this.recurse&&(f.push([c[m].before,c[m].on].filter(Boolean)),j.after=j.after.concat([c[m].after].filter(Boolean)),c===this.routes&&(f.push([c.before,c.on].filter(Boolean)),j.after=j.after.concat([c.after].filter(Boolean)))),f.matched=!0,f.captures=j.captures,f.after=j.after;return l(f)}}return!1},e.prototype.insert=function(a,b,c,d){var e,f,g,h,i;b=b.filter(function(a){return a&&a.length>0}),d=d||this.routes,i=b.shift(),/\:|\*/.test(i)&&!/\\d|\\w/.test(i)&&(i=j(i,this.params));if(b.length>0){d[i]=d[i]||{};return this.insert(a,b,c,d[i])}{if(!!i||!!b.length||d!==this.routes){f=typeof d[i],g=Array.isArray(d[i]);if(d[i]&&!g&&f=="object"){e=typeof d[i][a];switch(e){case"function":d[i][a]=[d[i][a],c];return;case"object":d[i][a].push(c);return;case"undefined":d[i][a]=c;return}}else if(f=="undefined"){h={},h[a]=c,d[i]=h;return}throw new Error("Invalid route context: "+f)}e=typeof d[a];switch(e){case"function":d[a]=[d[a],c];return;case"object":d[a].push(c);return;case"undefined":d[a]=c;return}}},e.prototype.extend=function(a){function e(a){b._methods[a]=!0,b[a]=function(){var c=arguments.length===1?[a,""]:[a];b.on.apply(b,c.concat(Array.prototype.slice.call(arguments)))}}var b=this,c=a.length,d;for(d=0;d<c;d++)e(a[d])},e.prototype.runlist=function(a){var b=this.every&&this.every.before?[this.every.before].concat(g(a)):g(a);this.every&&this.every.on&&b.push(this.every.on),b.captures=a.captures,b.source=a.source;return b},e.prototype.mount=function(a,b){function d(b,d){var e=b,f=b.split(c.delimiter),g=typeof a[b],h=f[0]===""||!c._methods[f[0]],i=h?"on":e;h&&(e=e.slice((e.match(new RegExp("^"+c.delimiter))||[""])[0].length),f.shift());h&&g==="object"&&!Array.isArray(a[b])?(d=d.concat(f),c.mount(a[b],d)):(h&&(d=d.concat(e.split(c.delimiter)),d=k(d,c.delimiter)),c.insert(i,d,a[b]))}if(!!a&&typeof a=="object"&&!Array.isArray(a)){var c=this;b=b||[],Array.isArray(b)||(b=b.split(c.delimiter));for(var e in a)a.hasOwnProperty(e)&&d(e,b.slice(0))}}})(typeof exports=="object"?exports:window);


/*! JsRender v1.0.0-beta: http://github.com/BorisMoore/jsrender and http://jsviews.com/jsviews
informal pre V1.0 commit counter: 54 */
(function(n,t,i){"use strict";function bt(n){return n}function tr(n){return n}function kt(n){o._dbgMode=n;yt=n?"Unavailable (nested view): use #getIndex()":"";g("dbg",hi.dbg=it.dbg=n?tr:bt)}function dt(n){return{getTgt:n,map:function(t){var r,i=this;i.src!==t&&(i.src&&i.unmap(),typeof t=="object"&&(r=n.apply(i,arguments),i.src=t,i.tgt=r))}}}function ot(n){this.name=(u.link?"JsViews":"JsRender")+" Error";this.message=n||this.name}function f(n,t){var i;n=n||{};for(i in t)n[i]=t[i];return n}function tt(n){return typeof n=="function"}function gt(n,t,i){return(!a.rTag||n)&&(p=n?n.charAt(0):p,w=n?n.charAt(1):w,s=t?t.charAt(0):s,v=t?t.charAt(1):v,nt=i||nt,n="\\"+p+"(\\"+nt+")?\\"+w,t="\\"+s+"\\"+v,y="(?:(?:(\\w+(?=[\\/\\s\\"+s+"]))|(?:(\\w+)?(:)|(>)|!--((?:[^-]|-(?!-))*)--|(\\*)))\\s*((?:[^\\"+s+"]|\\"+s+"(?!\\"+v+"))*?)",a.rTag=y+")",y=new RegExp(n+y+"(\\/)?|(?:\\/(\\w+)))"+t,"g"),vt=new RegExp("<.*>|([^\\\\]|^)[{}]|"+n+".*"+t)),[p,w,s,v,nt]}function ir(n,t){t||(t=n,n=i);var e,f,o,u,r=this,s=!t||t==="root";if(n){if(u=r.type===t?r:i,!u)if(e=r.views,r._.useKey){for(f in e)if(u=e[f].get(n,t))break}else for(f=0,o=e.length;!u&&f<o;f++)u=e[f].get(n,t)}else if(s)while(r.parent.parent)u=r=r.parent;else while(r&&!u)u=r.type===t?r:i,r=r.parent;return u}function ni(){var n=this.get("item");return n?n.index:i}function ti(){return this.index}function rr(t){var u,e=this,o=e.linkCtx,r=(e.ctx||{})[t];return r===i&&o&&o.ctx&&(r=o.ctx[t]),r===i&&(r=hi[t]),r&&tt(r)&&!r._wrp&&(u=function(){return r.apply(!this||this===n?e:this,arguments)},u._wrp=1,f(u,r)),u||r}function ur(n,t,u){var f,e,h,o=+u===u&&u,s=t.linkCtx;if(o&&(u=(o=t.tmpl.bnds[o-1])(t.data,t,r)),e=u.args[0],n||o){f=s&&s.tag;f||(f={_:{inline:!s,bnd:o},tagName:n+":",flow:!0,tagCtx:u,_is:"tag"},s&&(s.tag=f,f.linkCtx=s,u.ctx=l(u.ctx,s.view.ctx)));for(h in u.props)ft.test(h)&&(f[h]=u.props[h]);u.view=t;f.ctx=u.ctx||{};delete u.ctx;t._.tag=f;e=st(f,f.convert||n!=="true"&&n)[0];e=o&&t._.onRender?t._.onRender(e,t,o):e;t._.tag=i}return e!=i?e:""}function st(n,t){var r=n.tagCtx,u=r.view,i=r.args;return t=t&&(""+t===t?u.getRsc("converters",t)||h("Unknown converter: '"+t+"'"):t),i=!i.length&&!r.index&&n.autoBind?[u.data]:t?i.slice():i,t&&(t.depends&&(n.depends=a.getDeps(n.depends,n,t.depends,t)),i[0]=t.apply(n,i)),i}function fr(n,t){for(var f,e,u=this;f===i&&u;)e=u.tmpl[n],f=e&&e[t],u=u.parent;return f||r[n][t]}function er(n,t,u,o,s){var ct,c,pt,lt,ut,v,at,w,a,et,tt,wt,k,vt,yt,g,y,ot,nt,bt,d="",ht=+o===o&&o,p=t.linkCtx||0,rt=t.ctx,kt=u||t.tmpl;for(n._is==="tag"&&(c=n,n=c.tagName,o=c.tagCtxs),c=c||p.tag,ht&&(o=(wt=kt.bnds[ht-1])(t.data,t,r)),at=o.length,v=0;v<at;v++){if(v||u&&c||(k=t.getRsc("tags",n)||h("Unknown tag: {{"+n+"}}")),a=o[v],p.tag||(tt=a.tmpl,tt=a.content=tt&&kt.tmpls[tt-1],f(a,{tmpl:(c?c:k).template||tt,render:fi,index:v,view:t,ctx:l(a.ctx,rt)})),(u=a.props.tmpl)&&(u=""+u===u?t.getRsc("templates",u)||e(u):u,a.tmpl=u),c||(k._ctr?(c=new k._ctr,vt=!!c.init,c.attr=c.attr||k.attr||i):c={render:k.render},c._={inline:!p},p&&(p.attr=c.attr=p.attr||c.attr,p.tag=c,c.linkCtx=p),(c._.bnd=wt||p.fn)?c._.arrVws={}:c.dataBoundOnly&&h("{^{"+n+"}} tag must be data-bound"),c.tagName=n,c.parent=ut=rt&&rt.tag,c._is="tag",c._def=k,c.tagCtxs=o),!v)for(ot in nt=a.props)ft.test(ot)&&(c[ot]=nt[ot]);a.tag=c;c.map&&c.tagCtxs&&(a.map=c.tagCtxs[v].map);c.flow||(et=a.ctx=a.ctx||{},pt=c.parents=et.parentTags=rt&&l(et.parentTags,rt.parentTags)||{},ut&&(pt[ut.tagName]=ut),et.tag=c)}for(t._.tag=c,c.rendering={},v=0;v<at;v++)a=c.tagCtx=c.tagCtxs[v],nt=a.props,y=st(c,c.convert),(yt=nt.map||c).map&&(y.length||nt.map)&&(g=a.map=f(a.map||{unmap:yt.unmap},nt),g.src!==y[0]&&(g.src&&g.unmap(),yt.map.apply(g,y)),y=[g.tgt]),c.ctx=a.ctx,!v&&vt&&(bt=c.template,c.init(a,p,c.ctx),vt=i,c.template!==bt&&(c._.tmpl=c.template)),w=i,ct=c.render,(ct=c.render)&&(w=ct.apply(c,y)),y=y.length?y:[t],w=w!==i?w:a.render(y[0],!0)||(s?i:""),d=d?d+(w||""):w;return delete c.rendering,c.tagCtx=c.tagCtxs[0],c.ctx=c.tagCtx.ctx,c._.inline&&(lt=c.attr)&&lt!==b&&(d=lt==="text"?it.html(d):""),ht&&t._.onRender?t._.onRender(d,t,ht):d}function d(n,t,i,r,u,f,e,o){var a,h,c,s=this,v=t==="array",l={key:0,useKey:v?0:1,id:""+nr++,onRender:o,bnds:{}};s.data=r;s.tmpl=u;s.content=e;s.views=v?[]:{};s.parent=i;s.type=t;s._=l;s.linked=!!o;i?(a=i.views,h=i._,h.useKey?(a[l.key="_"+h.useKey++]=s,s.index=yt,s.getIndex=ni,c=h.tag,l.bnd=v&&(!c||!!c._.bnd&&c)):a.splice(l.key=s.index=f,0,s),s.ctx=n||i.ctx):s.ctx=n}function or(n){var t,i,r,u,f;for(t in k)if(u=k[t],(f=u.compile)&&(i=n[t+"s"]))for(r in i)i[r]=f(r,i[r],n,t,u)}function sr(n,t,r){var f,u;return tt(t)?t={depends:t.depends,render:t}:((u=t.template)!==i&&(t.template=""+u===u?e[u]||e(u):u),t.init!==!1&&(f=t._ctr=function(){},(f.prototype=t).constructor=f)),r&&(t._parentTmpl=r),t}function ii(r,u,f,o,s,h){function v(u){if(""+u===u||u.nodeType>0){try{a=u.nodeType>0?u:!vt.test(u)&&t&&t(n.document).find(u)[0]}catch(c){}return a&&(u=e[r=r||a.getAttribute(et)],u||(r=r||"_"+gi++,a.setAttribute(et,r),u=e[r]=ii(r,a.innerHTML,f,o,s,h)),a=i),u}}var c,a;return u=u||"",c=v(u),h=h||(u.markup?u:{}),h.tmplName=r,f&&(h._parentTmpl=f),!c&&u.markup&&(c=v(u.markup))&&c.fn&&(c.debug!==u.debug||c.allowCode!==u.allowCode)&&(c=c.markup),c!==i?(r&&!f&&(wt[r]=function(){return u.render.apply(u,arguments)}),c.fn||u.fn?c.fn&&(u=r&&r!==c.tmplName?l(h,c):c):(u=ri(c,h),ct(c.replace(yi,"\\$&"),u)),or(h),u):void 0}function ri(n,t){var i,e=o.wrapMap||{},r=f({markup:n,tmpls:[],links:{},tags:{},bnds:[],_is:"template",render:ui},t);return t.htmlTag||(i=bi.exec(n),r.htmlTag=i?i[1].toLowerCase():""),i=e[r.htmlTag],i&&i!==e.div&&(r.markup=u.trim(r.markup)),r}function hr(n,t){function u(e,o,s){var l,h,v,c;if(e&&""+e!==e&&!e.nodeType&&!e.markup){for(v in e)u(v,e[v],o);return r}return o===i&&(o=e,e=i),e&&""+e!==e&&(s=o,o=e,e=i),c=s?s[f]=s[f]||{}:u,h=t.compile,(l=a.onBeforeStoreItem)&&(h=l(c,e,o,h)||h),e?o===null?delete c[e]:c[e]=h?o=h(e,o,s,n,t):o:o=h(i,o),h&&o&&(o._is=n),(l=a.onStoreItem)&&l(c,e,o,h),o}var f=n+"s";r[f]=u;k[n]=t}function cr(n,t){var i=this.jquery&&(this[0]||h('Unknown template: "'+self.selector+'"')),r=i.getAttribute(et);return ui.call(r?e[r]:e(i),n,t)}function ht(n,t,i){if(o._dbgMode)try{return n.fn(t,i,r)}catch(u){return h(u,i)}return n.fn(t,i,r)}function ui(n,t,i,r,f,e){var o=this;return!r&&o.fn._nvw&&!u.isArray(n)?ht(o,n,{tmpl:o}):fi.call(o,n,t,i,r,f,e)}function fi(n,t,r,f,o,s){var y,ut,g,a,nt,tt,it,p,v,rt,w,ft,h,et,c=this,k="";if(!!t===t&&(r=t,t=i),o===!0&&(it=!0,o=0),c.tag?(p=c,c=c.tag,rt=c._,ft=c.tagName,h=rt.tmpl||p.tmpl,et=c.attr&&c.attr!==b,t=l(t,c.ctx),v=p.content,p.props.link===!1&&(t=t||{},t.link=!1),f=f||p.view,n=arguments.length?n:f):h=c,h&&(!f&&n&&n._is==="view"&&(f=n),f&&(v=v||f.content,s=s||f._.onRender,n===f&&(n=f.data),t=l(t,f.ctx)),f&&f.data!==i||((t=t||{}).root=n),h.fn||(h=e[h]||e(h)),h)){if(s=(t&&t.link)!==!1&&!et&&s,w=s,s===!0&&(w=i,s=f._.onRender),t=h.helpers?l(h.helpers,t):t,u.isArray(n)&&!r)for(a=it?f:o!==i&&f||new d(t,"array",f,n,h,o,v,s),y=0,ut=n.length;y<ut;y++)g=n[y],nt=new d(t,"item",a,g,h,(o||0)+y,v,s),tt=ht(h,g,nt),k+=a._.onRender?a._.onRender(tt,nt):tt;else(f||!h.fn._nvw)&&(a=it?f:new d(t,ft||"data",f,n,h,o,v,s),rt&&!c.flow&&(a.tag=c)),k+=ht(h,n,a);return w?w(k,a):k}return""}function h(n,t,i){var r=o.onError(n,t,i);if(""+n===n)throw new a.Err(r);return!t.linkCtx&&t.linked?it.html(r):r}function c(n){h("Syntax error\n"+n)}function ct(n,t,i,r){function k(t){t-=f;t&&h.push(n.substr(f,t).replace(ut,"\\n"))}function l(t){t&&c('Unmatched or missing tag: "{{/'+t+'}}" in template:\n'+n)}function d(e,o,v,y,p,d,nt,tt,it,rt,et,ot){d&&(p=":",y=b);rt=rt||i;var st=(o||i)&&[],ct="",lt="",at="",vt="",yt="",pt="",wt="",ht=!rt&&!p&&!nt;v=v||(it=it||"#data",p);k(ot);f=ot+e.length;tt?g&&h.push(["*","\n"+it.replace(vi,"$1")+"\n"]):v?(v==="else"&&(wi.test(it)&&c('for "{{else if expr}}" use "{{else expr}}"'),st=u[6],u[7]=n.substring(u[7],ot),u=s.pop(),h=u[2],ht=!0),it&&si(it.replace(ut," "),st,t,i).replace(pi,function(n,t,i,r,u,f,e,o){return e?(lt+=f+",",vt+="'"+o+"',"):i?(at+=r+f+",",pt+=r+"'"+o+"',"):t?wt+=f:(ct+=r+f+",",yt+=r+"'"+o+"',",w=w||ft.test(u)),""}).slice(0,-1),a=[v,y||!!r||w||"",ht&&[],ei(vt,yt,pt),ei(lt,ct,at),wt,st||0],h.push(a),ht&&(s.push(u),u=a,u[7]=f)):et&&(l(et!==u[0]&&u[0]!=="else"&&et),u[7]=n.substring(u[7],ot),u=s.pop());l(!u&&et);h=u[2]}var o,a,w,g=t&&t.allowCode,e=[],f=0,s=[],h=e,u=[,,e];return i&&(n=p+n+v),l(s[0]&&s[0][2].pop()[0]),n.replace(y,d),k(n.length),(f=e[e.length-1])&&l(""+f!==f&&+f[7]===f[7]&&f[0]),i?(o=lt(e,n,i),o.paths=e[0][6]):o=lt(e,t),o._nvw&&(o._nvw=!/[~#]/.test(n)),o}function ei(n,t,i){return[n.slice(0,-1),t.slice(0,-1),i.slice(0,-1)]}function oi(n,t){return"\n\t"+(t?t+":{":"")+"args:["+n[0]+"]"+(n[1]||!t?",\n\tprops:{"+n[1]+"}":"")+(n[2]?",\n\tctx:{"+n[2]+"}":"")}function si(n,t,i){function p(p,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,lt,at,vt,yt,pt){function dt(n,i,r,f,e,s,h,c){if(r&&(t&&(u==="linkTo"&&(o=t._jsvto=t._jsvto||[],o.push(g)),(!u||l)&&t.push(g.slice(i.length))),r!==".")){var a=(f?'view.hlp("'+f+'")':e?"view":"data")+(c?(s?"."+s:f?"":e?"":"."+r)+(h||""):(c=f?"":e?s||"":r,""));return a=a+(c?"."+c:""),i+(a.slice(0,9)==="view.data"?a.slice(5):a)}return n}nt=nt||"";k=k||b||et;g=g||rt;ut=ut||at||"";var bt,kt,wt;if(!tt||e||f)return t&&lt&&!e&&!f&&(!u||l||o)&&(bt=y[r],pt.length-1>yt-bt&&(bt=pt.slice(bt,yt+1),lt=w+":"+bt+s,wt=v[lt],wt||(v[lt]=1,v[lt]=wt=ct(lt,i||t,!0),wt.paths.push({_jsvOb:wt})),wt!==1&&(o||t).push({_jsvOb:wt}))),e?(e=!ot,e?p:'"'):f?(f=!st,f?p:'"'):(k?(r++,y[r]=yt++,k):"")+(vt?r?"":(h=pt.slice(h,yt),u?(u=l=o=!1,"\b"):"\b,")+h+(h=yt+p.length,"\b"):it?(r&&c(n),u=g,l=d,h=yt+p.length,g+":"):g?g.split("^").join(".").replace(li,dt)+(ut?(a[++r]=!0,g.charAt(0)!=="."&&(y[r]=yt),kt?"":ut):nt):nt?nt:ht?(a[r--]=!1,ht)+(ut?(a[++r]=!0,ut):""):ft?(a[r]||c(n),","):b?"":(e=ot,f=st,'"'));c(n)}var u,o,l,f,e,h=0,v=i?i.links:t&&(t.links=t.links||{}),a={},y={0:-1},r=0;return(n+(i?" ":"")).replace(/\)\^/g,").").replace(ai,p)}function lt(n,i,r){var y,f,e,l,d,ht,ct,wt,at,g,rt,p,o,ft,et,v,nt,w,tt,vt,k,yt,pt,ot,s,a,st,h=0,u="",it={},bt=n.length;for(""+i===i?(v=r?'data-link="'+i.replace(ut," ").slice(1,-1)+'"':i,i=0):(v=i.tmplName||"unnamed",i.allowCode&&(it.allowCode=!0),i.debug&&(it.debug=!0),p=i.bnds,et=i.tmpls),y=0;y<bt;y++)if(f=n[y],""+f===f)u+='\n+"'+f+'"';else if(e=f[0],e==="*")u+=";\n"+f[1]+"\nret=ret";else{if(l=f[1],tt=f[2],d=oi(f[3],"params")+"},"+oi(ft=f[4]),a=f[5],vt=f[7],(pt=e==="else")||(h=0,p&&(o=f[6])&&(h=p.push(o))),(ot=e===":")?l&&(e=l===b?">":l+e):(tt&&(nt=ri(vt,it),nt.tmplName=v+"/"+e,lt(tt,nt),et.push(nt)),pt||(w=e,yt=u,u=""),k=n[y+1],k=k&&k[0]==="else"),st=a?";\ntry{\nret+=":"\n+",ot&&(o||l&&l!==b)){if(s="return {"+d+"};",a&&(s="try {\n"+s+"\n}catch(e){return {error: j._err(e,view,"+a+")}}\n"),s=new Function("data,view,j,u"," // "+v+" "+h+" "+e+"\n"+s),s.paths=o,s._tag=e,r)return s;rt=1}if(u+=ot?(r?(a?"\ntry{\n":"")+"return ":st)+(rt?(rt=0,g=at=!0,'c("'+l+'",view,'+(o?(p[h-1]=s,h):"{"+d+"}")+")"):e===">"?(ct=!0,"h("+ft[0]+")"):(wt=!0,"((v="+ft[0]+')!=null?v:"")')):(g=ht=!0,"\n{view:view,tmpl:"+(tt?et.length:"0")+","+d+"},"),w&&!k){if(u="["+u.slice(0,-1)+"]",(r||o)&&(u=new Function("data,view,j,u"," // "+v+" "+h+" "+w+"\nreturn "+u+";"),o&&((p[h-1]=u).paths=o),u._tag=e,r))return u;u=yt+st+'t("'+w+'",view,this,'+(h||u)+")";o=0;w=0}a&&(g=!0,u+=";\n}catch(e){ret"+(r?"urn ":"+=")+"j._err(e,view,"+a+");}\n"+(r?"":"ret=ret"))}u="// "+v+"\nj=j||"+(t?"jQuery.":"jsviews.")+"views;var v"+(ht?",t=j._tag":"")+(at?",c=j._cnvt":"")+(ct?",h=j.converters.html":"")+(r?";\n":',ret=""\n')+(it.debug?"debugger;":"")+u+(r?"\n":";\nreturn ret;");try{u=new Function("data,view,j,u",u)}catch(kt){c("Compiled template code:\n\n"+u+'\n: "'+kt.message+'"')}return i&&(i.fn=u),g||(u._nvw=!0),u}function l(n,t){return n&&n!==t?t?f(f({},t),n):n:t&&f({},t)}function lr(n){return pt[n]||(pt[n]="&#"+n.charCodeAt(0)+";")}function ar(n){var i,t,r=[];if(typeof n=="object")for(i in n)t=n[i],t&&t.toJSON&&!t.toJSON()||tt(t)||r.push({key:i,prop:n[i]});return r}function ci(n){return n!=null?ki.test(n)&&(""+n).replace(di,lr)||n:""}if((!t||!t.views)&&!n.jsviews){var u,rt,y,vt,yt,p="{",w="{",s="}",v="}",nt="^",li=/^(!*?)(?:null|true|false|\d[\d.]*|([\w$]+|\.|~([\w$]+)|#(view|([\w$]+))?)([\w$.^]*?)(?:[.[^]([\w$]+)\]?)?)$/g,ai=/(\()(?=\s*\()|(?:([([])\s*)?(?:(\^?)(!*?[#~]?[\w$.^]+)?\s*((\+\+|--)|\+|-|&&|\|\||===|!==|==|!=|<=|>=|[<>%*:?\/]|(=))\s*|(!*?[#~]?[\w$.^]+)([([])?)|(,\s*)|(\(?)\\?(?:(')|("))|(?:\s*(([)\]])(?=\s*\.|\s*\^|\s*$)|[)\]])([([]?))|(\s+)/g,ut=/[ \t]*(\r\n|\n|\r)/g,vi=/\\(['"])/g,yi=/['"\\]/g,pi=/(?:\x08|^)(onerror:)?(?:(~?)(([\w$]+):)?([^\x08]+))\x08(,)?([^\x08]+)/gi,wi=/^if\s/,bi=/<(\w+)[>\s]/,ki=/[\x00`><\"'&]/,ft=/^on[A-Z]|^convert(Back)?$/,di=/[\x00`><"'&]/g,gi=0,nr=0,pt={"&":"&amp;","<":"&lt;",">":"&gt;","\x00":"&#0;","'":"&#39;",'"':"&#34;","`":"&#96;"},b="html",et="data-jsv-tmpl",wt={},k={template:{compile:ii},tag:{compile:sr},helper:{},converter:{}},r={jsviews:"v1.0.0-beta",settings:function(n){f(o,n);kt(o._dbgMode);o.jsv&&o.jsv()},sub:{View:d,Err:ot,tmplFn:ct,cvt:st,parse:si,extend:f,syntaxErr:c,DataMap:dt},_cnvt:ur,_tag:er,_err:h};(ot.prototype=new Error).constructor=ot;ni.depends=function(){return[this.get("item"),"index"]};ti.depends=function(){return["index"]};d.prototype={get:ir,getIndex:ti,getRsc:fr,hlp:rr,_is:"view"};for(rt in k)hr(rt,k[rt]);var at,e=r.templates,it=r.converters,hi=r.helpers,g=r.tags,a=r.sub,o=r.settings;t?(u=t,u.fn.render=cr,(at=u.observable)&&(f(a,at.sub),delete at.sub)):(u=n.jsviews={},u.isArray=Array&&Array.isArray||function(n){return Object.prototype.toString.call(n)==="[object Array]"});u.render=wt;u.views=r;u.templates=e=r.templates;o({debugMode:kt,delimiters:gt,onError:function(n,t,r){return t&&(n=r===i?"{Error: "+n+"}":tt(r)?r(n,t):r),n},_dbgMode:!0});g({"else":function(){},"if":{render:function(n){var t=this;return t.rendering.done||!n&&(arguments.length||!t.tagCtx.index)?"":(t.rendering.done=!0,t.selected=t.tagCtx.index,t.tagCtx.render(t.tagCtx.view,!0))},onUpdate:function(n,t,i){for(var r,f,u=0;(r=this.tagCtxs[u])&&r.args.length;u++)if(r=r.args[0],f=!r!=!i[u].args[0],!this.convert&&!!r||f)return f;return!1},flow:!0},"for":{render:function(n){var f,t=this,r=t.tagCtx,e="",o=0;return t.rendering.done||((f=!arguments.length)&&(n=r.view.data),n!==i&&(e+=r.render(n,f),o+=u.isArray(n)?n.length:1),(t.rendering.done=o)&&(t.selected=r.index)),e},flow:!0,autoBind:!0},include:{flow:!0,autoBind:!0},"*":{render:bt,flow:!0}});g({props:f(f({},g["for"]),dt(ar))});g.props.autoBind=!0;it({html:ci,attr:ci,url:function(n){return n!=i?encodeURI(""+n):n===null?n:""}});gt()}})(this,this.jQuery);




$("document").ready(function(){function p(a){k("topic");f(c);$.ajax({url:j,type:"POST",dataType:"json",data:{action:"topic",paged:a},success:function(b){if(b.items){for(var e=0;e<b.items.length;e++)b.items[e].status_cn=v[b.items[e].status];c.html('<ul class="user-postlist user-topiclist"></ul>');$(".user-topiclist").html($("#temp-topicitem").render(b.items)).after(m(b.max,a,"#topic/"))}else f(c,g["1101"])},error:function(){f(c,g["1079"])}})}function q(a){k("like");f(c);$.ajax({url:j,type:"POST",dataType:"json",
data:{action:"like",paged:a},success:function(b){b.items?(c.html('<ul class="user-postlist"></ul>'),$(".user-postlist").html($("#temp-postitem").render(b.items)).after(m(b.max,a,"#like/"))):f(c,g["1401"]);r()},error:function(){f(c,g["1079"])}})}function s(a){k("comment");f(c);$.ajax({url:j,type:"POST",dataType:"json",data:{action:"comment",paged:a},success:function(b){b.items?(c.html('<ul class="user-commentlist"></ul>'),$(".user-commentlist").html($("#temp-commentitem").render(b.items)).after(m(b.max,
a,"#comment/"))):f(c,g["1301"])},error:function(){f(c,g["1079"])}})}function h(a,b,e){k("post");$(".user-postmenu a").removeClass();f(c);var d={action:"post",status:a,paged:b};l||(d.first=!0);$.ajax({url:j,type:"POST",dataType:"json",data:d,success:function(d){if(!l&&d.menus)l=d.menus;if((l||!l&&d.menus)&&!$(".user-postmenu").length){c.before('<div class="user-postmenu"></div>');$(".user-postmenu").html($("#temp-postmenu").render(l||d.menus))}if(d.items){c.html('<ul class="user-postlist"></ul>');
$(".user-postlist").html($("#temp-postitem").render(d.items)).after(m(d.max,b,"#post/"+a+"/"));r()}else f(c,g["1201"]);e&&e()},error:function(){f(c,g["1079"])}})}function k(a){$(".usermenus li").removeClass("active");$(".usermenu-"+a).addClass("active")}function f(a,b){b||(b='<img src="'+jsui.uri+'/img/loading_line.gif">');a.html('<div class="user-loading">'+b+"</div>")}function r(){$(".user-main .thumb").lazyload({data_attribute:"src",placeholder:jsui.uri+"/img/thumbnail.png",threshold:400})}function m(a,
b,c){if(!(10>=a)){var a=Math.ceil(a/10),d='<div class="pagination user-pagination"><ul>';b||(b=1);b=Number(b);3<b&&(d+='<li><a href="'+c+'1">1</a></li>');4<b&&(d+="<li><span>...</span></li>");for(i=b-2;i<=b+2;i++)0<i&&i<=a&&(d+=i==b?'<li class="active"><span>'+i+"</span></li>":'<li><a href="'+c+i+'">'+i+"</a></li>");b<a-2-1&&(d+="<li><span>...</span></li>");b<a-2&&(d+='<li><a href="'+c+a+'">'+a+"</a></li>");return d+("<li><span>\u5171"+a+"\u9875</span></li>")+"</ul></div>"}}function e(a){if(!a)return!1;
o&&clearTimeout(o);$(".user-tips").html(a).animate({top:78},220);o=setTimeout(function(){$(".user-tips").animate({top:48},220)},5E3)}function t(a){return/^((http|https)\:\/\/)([a-z0-9-]{1,}.)?[a-z0-9-]{2,}.([a-z0-9-]{1,}.)?[a-z0-9]{2,}$/.test(a)}$("#contentframe");var c=$(".user-main"),l=null,n=null,w=/^#post\//,j=jsui.uri+"/action/user.php",g={1079:"\u670d\u52a1\u5668\u5f02\u5e38\uff0c\u8bf7\u7a0d\u5019\u518d\u8bd5\uff01",1101:"\u6682\u65e0\u547d\u9898\uff01",1102:"\u5982\uff1a\u4e2d\u56fd\u6700\u9177\u6700\u503c\u5f97\u53bb\u7684\u7011\u5e03",
1103:"\u5b57\u6570\u9650\u5236\uff1a8-24\uff0c\u8bf7\u5b8c\u5584\u547d\u9898",1104:"\u5b57\u6570\u9650\u5236\uff1a8-24\uff0c\u8bf7\u7cbe\u7b80\u5e76\u7a81\u51fa\u4e3b\u9898",1171:"\u5b57\u6570\u9650\u5236\uff1a8-24",1172:"\u4f60\u6bcf\u5929\u6700\u591a\u547d\u98985\u6761\uff0c\u7ed9\u5c0f\u7f16\u6761\u6d3b\u8def\u5427...",1173:"\u547d\u9898\u6210\u529f\uff01 \u4f60\u4eca\u5929\u8fd8\u53ef\u4ee5\u547d\u9898\u6761\u6570\u4e3a\uff1a",1201:"\u6682\u65e0\u6587\u7ae0\uff01",1301:"\u6682\u65e0\u8bc4\u8bba\uff01",
1401:"\u6682\u65e0\u70b9\u8d5e\u6587\u7ae0\uff01"},u=Router({"post/all":function(){h("all",1);$(".user-postmenu a:eq(0)").addClass("active")},"post/all/:paged":function(a){h("all",a);$(".user-postmenu a:eq(0)").addClass("active")},"post/publish":function(){h("publish",1);$(".user-postmenu a:eq(1)").addClass("active")},"post/publish/:paged":function(a){h("publish",a);$(".user-postmenu a:eq(1)").addClass("active")},"post/future":function(){h("future",1);$(".user-postmenu a:eq(2)").addClass("active")},
"post/future/:paged":function(a){h("future",a);$(".user-postmenu a:eq(2)").addClass("active")},"post/pending":function(){h("pending",1);$(".user-postmenu a:eq(3)").addClass("active")},"post/pending/:paged":function(a){h("pending",a);$(".user-postmenu a:eq(3)").addClass("active")},"post/draft":function(){h("draft",1);$(".user-postmenu a:eq(4)").addClass("active")},"post/draft/:paged":function(a){h("draft",a);$(".user-postmenu a:eq(4)").addClass("active")},"post/trash":function(){h("trash",1);$(".user-postmenu a:eq(5)").addClass("active")},
"post/trash/:paged":function(a){h("trash",a);$(".user-postmenu a:eq(5)").addClass("active")},comment:function(){s(1)},"comment/:paged":function(a){s(a)},like:function(){q(1)},"like/:paged":function(a){q(a)},topic:function(){p(1)},"topic/edit":function(){k("topicedit");f(c);c.html($("#temp-topicedit").render());$("#topicedit-form .form-control").on("input",function(){var a=$.trim($(this).val().length),b=$("#topicedit-form").next("h4");0==a?($(this).removeClass("error"),b.attr("class","").html(g["1102"])):
0<a&&8>a?($(this).addClass("error"),b.attr("class","error").html(g["1103"])):8<=a&&24>=a?($(this).removeClass("error"),b.attr("class","").html(g["1102"])):24<a&&($(this).addClass("error"),b.attr("class","error").html(g["1104"]))})},"topic/:paged":function(a){p(a)},user:function(){k("user");f(c);n?c.html($("#temp-user").render(n)):$.ajax({url:j,type:"POST",dataType:"json",data:{action:"user"},success:function(a){a.user?(n=a.user,c.html($("#temp-user").render(a.user))):f(c,g["1101"])},error:function(){f(c,
g["1079"])}})}});u.configure({on:function(){w.test(location.hash)||$(".user-postmenu").remove()},notfound:function(){location.hash="topic/edit"}});u.init();location.hash||(location.hash="topic/edit");var v={publish:"\u5df2\u53d1\u5e03",pending:"\u5f85\u5ba1\u4e2d",future:"\u5df2\u91c7\u7eb3 \u7f16\u8f91\u4e2d",trash:"\u5047\u547d\u9898"},o;$(document).on("click",function(a){a=a||window.event;a=$(a.target||a.srcElement);a.parent().attr("evt")?a=$(a.parent()[0]):a.parent().parent().attr("evt")&&(a=
$(a.parent().parent()[0]));var b=a.attr("evt");if(b)switch(b){case "topic.edit.submit":var a=$.trim($("#topicedit-form .form-control").val()),b=a.length,h=$("#topicedit-form").next("h4");if(b<8||b>24)break;$.ajax({url:j,type:"POST",dataType:"json",data:{action:"topic.insert",title:a},success:function(a){if(a.error)h.attr("class","error").html(g[a.error]);else{h.attr("class","success").html(g["1173"]+a.max);$("#topicedit-form .form-control").val("").focus()}},error:function(){f(c,g["1079"])}});break;
case "user.data.submit":a=a.parent().parent().parent().serializeObject();b=false;a.action==="user.password"&&(b=true);if(!a.action)break;if(b){if(!$.trim(a.passwordold)){e("\u8bf7\u8f93\u5165\u539f\u5bc6\u7801");break}if(!a.password||a.password.length<6){e("\u65b0\u5bc6\u7801\u4e0d\u80fd\u4e3a\u7a7a\u4e14\u81f3\u5c116\u4f4d");break}if(a.password!==a.password2){e("\u4e24\u6b21\u5bc6\u7801\u8f93\u5165\u4e0d\u4e00\u81f4");break}if(a.passwordold===a.password){e("\u65b0\u5bc6\u7801\u548c\u539f\u5bc6\u7801\u4e0d\u80fd\u76f8\u540c");
break}}else{if(!a.nickname){e("\u6635\u79f0\u4e0d\u80fd\u4e3a\u7a7a");break}if(a.nickname.length>12){e("\u6635\u79f0\u9650\u5236\u572812\u4e2a\u5b57\u5185");break}if(!a.email){e("\u90ae\u7bb1\u4e0d\u80fd\u4e3a\u7a7a");break}if(!/^[_a-z0-9-]+(\.[_a-z0-9-]+)*@[a-z0-9-]+(\.[a-z0-9-]+)*(\.[a-z]{2,4})$/.test(a.email)){e("\u90ae\u7bb1\u683c\u5f0f\u9519\u8bef");break}if(a.url&&(!t(a.url)||a.url.length>100)){e("\u7f51\u5740\u683c\u5f0f\u9519\u8bef");break}if(a.qq&&!/^[1-9]\d{4,13}$/.test(a.qq)){e("QQ\u683c\u5f0f\u9519\u8bef");
break}if(a.weixin&&a.weixin.length>30){e("\u5fae\u4fe1\u5b57\u6570\u8fc7\u957f\uff0c\u9650\u5236\u572830\u5b57\u5185");break}if(a.weibo&&(!t(a.weibo)||a.weibo.length>100)){e("\u5fae\u535a\u683c\u5f0f\u9519\u8bef");break}}$.ajax({type:"POST",url:j,data:a,dataType:"json",success:function(a){if(a.error)a.msg&&e(a.msg);else{e("\u4fee\u6539\u6210\u529f\uff01");n=null;$(".user-meta:eq(1) input:password").val("")}}})}})});